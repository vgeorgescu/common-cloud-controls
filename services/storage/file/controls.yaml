common_controls:
  - CCC.C01 # Prevent unencrypted requests
  - CCC.C02 # Ensure data encryption at rest for all stored data
  - CCC.C03 # Implement multi-factor authentication (MFA) for access
  - CCC.C04 # Log all access and changes
  - CCC.C05 # Prevent access from untrusted entities
  - CCC.C06 # Prevent deployment in restricted regions
  - CCC.C07 # Alert on non-human enumeration
  - CCC.C09 # Prevent tampering, deletion, or unauthorized access to access logs
  - CCC.C10 # Prevent data replication to desinations outside of defined trust perimeter
 
controls:
  - id: CCC.FileStor.C01 # Restrict Access to Trusted KMS keys
    title: Restrict File Access to trusted KMS Keys
    objective: |
      Prevent unauthorised file encryption by ensuring that only trusted KMS are used for file access.
    control_family: Data Security
    threats:
      - CCC.TH01 # Access control is misconfigured
      - CCC.TH06 # Data is lost or corrupted
    nist_csf: PR.DS-1 # Data-at-rest is protected
    control_mappings:
      CCM:
        - DCS-04 # Data Protection and Encryption
        - DCS-06 # Data Integrity
      ISO_27001:
        - 2013 A.10.1.1 # Policy on the use of cryptographic controls
      NIST_800_53:
        - SC-28 # Protection of Information at Rest
    test_requirements:
      - id: CCC.FileStor.C01.TR01
        text: |
          The service prevents access to any object directory or file
          that uses KMS keys not listed as trusted by the organization.
        tlp_levels:
          - tlp_clear
          - tlp_green
          - tlp_amber
          - tlp_red
 
  - id: CCC.FileStor.C02 # Enforce uniform File-Level Access to Prevent Inconsistent
    title: Enforce uniform File-Level Access to Prevent Inconsistent
    control_family: Identity and Access Management
    objective: |
      Enforce consistent directory-level access accross all file storage directories to
      prevent unauthorised access from inconsistent permissions. Enforces centralised, secure access management
      in accordance with the principle of least privilege.
    threats:
      - CCC.TH01 # Access control is misconfigured
      - CCC.FileStor.TH02 # Improper enforcement of object modification locks
    nist_csf: PR.AC-4 # Access permissions and authorizations are managed, incorporating the principles of least privilege and separation of duties
    control_mappings:
      CCM:
        - DCS-09 # Access Control
      ISO_27001:
        - 2013 A.9.4.1 # Information Access Restriction
      NIST_800_53:
        - AC-3 # Access Enforcement
        - AC-6 # Least Privilege
    test_requirements:
      - id: CCC.FileStor.C02.TR01
        text: |
          Admin users can configure file-level permissions uniformly across
          all directory, ensuring that file-level permissions cannot be
          applied without explicit authorization.
        tlp_levels:
          - tlp_amber
          - tlp_red
 
  - id: CCC.FileStor.C03 # Restrict file or directory deletion Permission through IAM policy
    title: Restrict File or Directory Deletion Permission
    control_family: Data Security
    objective: |
      Ensure that file or directory can only be deleted by authorised IAM role through policy, preventing unauthorised
      deletion. This Ensures only authorised administratord can modify these settings.
    threats:
      - CCC.TH06 # Data is lost or corrupted
    nist_csf: PR.DS-1 # Data-at-rest is protected
    test_requirements:
      - id: CCC.FileStor.C03.TR01
        text: |
          Storage dorectory cannot be deleted after creation.
        tlp_levels:
          - tlp_clear
          - tlp_green
          - tlp_amber
          - tlp_red
      - id: CCC.FileStor.C03.TR02
        text: |
          Deletion policy for storage directory cannot be chnage by non administrator.
        tlp_levels:
          - tlp_clear
          - tlp_green
          - tlp_amber
          - tlp_red